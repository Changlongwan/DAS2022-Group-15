---
title: "category and depth part"
output:
  html_document:
    df_print: paged
date: '2022-03-16'
---

```{r setup}
knitr::opts_chunk$set(echo = TRUE)
```

# packages
```{r,include=FALSE}
library(kableExtra)
library(gridExtra)
library(tinytex)
library(equatiomatic)
library(gapminder)
library(ggplot2)
library(dplyr)
library(moderndive)
library(skimr)
library(plotly)
library(tidyr)
library(jtools)
library(janitor)
library(infer)
library(broom)
library(sjPlot)
library(stats)
```

# read data
```{r}
setwd("C:/Users/m/Desktop")
IKEA<-read.csv("dataset15_c377a7f5caf56227927dbf53ce856d97.csv")
```

# select variables
```{r}
IKEA<-IKEA %>%
  select(category,price,sellable_online,other_colors,depth,height,width)
```

# handling NA variables
```{r}
IKEA<-na.omit(IKEA)
```

# handling factor variables
```{r}
IKEA$category<-as.factor(IKEA$category)

IKEA$sellable_online<-as.factor(IKEA$sellable_online)

IKEA$other_colors<-as.factor(IKEA$other_colors)

IKEA$price[IKEA$price<1000]<-"p<1000"
IKEA$price[IKEA$price!="p<1000"]<-"p>=1000"
IKEA$price<-as.factor(IKEA$price)
```

# category
Exploratory analysis:
```{r}
ggplot(data=IKEA,aes(x = price, group = category))+
  geom_bar(aes(y = ..prop..,fill = category), stat = "count", position = "dodge")+
  labs(x="price",y="category")
```

Logistic regression model:
```{r}
model.category<-glm(price ~ category, data = IKEA, family = binomial(link = "logit"))

equatiomatic::extract_eq(model.category)
model.category%>%
  summary()
```
From the above results, the p-values of each factor in category are too large, thus we can conclude that variable category have no  impact on price.

#depth
Exploratory analysis:
```{r}
ggplot(data = IKEA,aes(x = price, y = depth, fill = price))+
  geom_boxplot()+
  labs(x="price",y="depth")
```

Logistic regression model:
```{r}
model.depth<-glm(price ~ depth, data = IKEA, family = binomial(link = "logit"))

equatiomatic::extract_eq(model.depth)
model.depth%>%
  summary()

```
From the above results, the p-value is smaller than 0.025, thus we can conclude that variable depth have impact on price.
And with depth increases one unit, the log-odds of price(p>1000) will increase 0.03.

95% confidence interval:
```{r}
confint(model.depth)%>%
  kable()
```

Log odds:
```{r}
plot_model(model.depth,show.values = TRUE,title = "Logodds(p>1000)", show.p = FALSE)
```
The above figure shows the 95% CI of depth is 1.03


